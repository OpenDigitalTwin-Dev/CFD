sudo apt -y install libhypre-dev libboost-all-dev cmake libeigen3-dev gcc gfortran libhdf5-openmpi-dev libmuparser-dev m4 petsc-dev libopenmpi-dev libsiloh5-dev wget which

cd ../../Tools/fftw/
./install

cd ../../NLA/lapack/
./install.sh

cd ../../NLA/petsc/
./install_ibamr

cd ../../CFD/libmesh
./install

cd ../ibsamrai2/
./install

cd ../

current_path=$(pwd)

cd ibamr

echo $current_path

mkdir build
cd build

# >>> it is very strange -DSAMRAI_ROOT=$HOME/Downloads/install/samrai_install can't use $PWD/../ it seems that ../ has some problems

# don't use -DIBAMR_FORCE_BUNDLED_MUPARSER=ON for ubuntu 22.04 bundled_muparser is OK but for 24.04 the version has some prolbem.

cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=$PWD/../../install/ibamr_install -DPETSC_ROOT=$PWD/../../../NLA/install/petsc_install -DSAMRAI_ROOT=$current_path/install/samrai_install -DLIBMESH_ROOT=$PWD/../../install/libmesh_install -DLIBMESH_METHOD=DEVEL -DIBAMR_FORCE_BUNDLED_BOOST=ON -DIBAMR_FORCE_BUNDLED_EIGEN3=ON ..



make -j4
make install
